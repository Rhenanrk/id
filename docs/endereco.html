<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="author" content="Fábio Nogueira de Lucena">
  <link rel="shortcut icon" href="favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>ABNT 15985</title>
  <meta name="description" content="Apresentação detalhada da norma ABNT NBR 15985:2011">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="css/bulma.css">
  <link rel="stylesheet" href="css/tooltip.css">

  <style>
    .dropdown-item:hover {
      background-color: lightgray;
    }
    
    #table-vinculos {
      cursor: pointer;
    }
  </style>
</head>

<body>
  <script>
    window.onkeydown = function(event) {
      if (event.keyCode == 27) {
        feche();
      }
    };

    function removeLinha(x) {
      var i = x.parentNode.parentNode.rowIndex;
      document.getElementById("table-vinculos").deleteRow(i);
    }

    function abra() {
      var d = document.getElementById("vinculo-di-atualiza");
      d.value = dataCorrente();

      var n = document.getElementById('vinculo-nome-pessoa');
      n.innerHTML = "O nome do vínculo com o paciente";

      var k = document.getElementById('edita-vinculo');
      k.classList.add('is-active');
    }

    function feche() {
      var k = document.getElementById('edita-vinculo');
      k.classList.remove('is-active');
    }

    function atualize() {
      var k = document.getElementById('edita-vinculo');
      k.classList.remove('is-active');
    }

    function dataCorrente() {
      var local = new Date();
      local.setMinutes(local.getMinutes() - local.getTimezoneOffset());
      return local.toJSON().slice(0, 10);
    }
    
    function showRow(x) {
      alert(x.rowIndex + " " + x.cells[0].innerHTML);
    }
  </script>

  <table class="table is-bordered is-striped is-hoverable" id="table-vinculos">
    <thead>
      <tr>
        <th>Vínculo</th>
        <th>Tipo</th>
        <th>Início</th>
        <th>Fim</th>
        <th>Remover</th>
      </tr>
    </thead>
    <tbody>
      <tr onclick="showRow(this)">
        <td>Fulano da Silva Sauro Dinocrópio</td>
        <td>Mãe adotiva</td>
        <td>--</td>
        <td>--</td>
        <td>          <span class="icon has-text-info">
            <i class="fa fa-pencil" aria-hidden="true"></i>
          </span>
          <span class="icon has-text-danger" onclick="removeLinha(this)">
            <i class="fa fa-times" aria-hidden="true"></i>
          </span>
        </td>
      </tr>
      <tr onclick="showRow(this)">
        <td>Maria da Silva de Antônia e Bento Ferreira</td>
        <td>Conjugê/companheiro(a)</td>
        <td>--</td>
        <td>--</td>
        <td>
          <span class="icon has-text-danger" onclick="removeLinha(this)">
            <i class="fa fa-times" aria-hidden="true"></i>
          </span>
        </td>
      </tr>
      <tr onclick="showRow(this)">
        <td>Fulana Saura Dinocrópia Filha</td>
        <td>Irmã</td>
        <td>--</td>
        <td>--</td>
        <td>
          <span class="icon has-text-danger" onclick="removeLinha(this)">
            <i class="fa fa-times" aria-hidden="true"></i>
          </span>
        </td>
      </tr>
      <tr onclick="showRow(this)">
        <td>Beltrano Fulano de Silva</td>
        <td>Avô paterno</td>
        <td>--</td>
        <td>--</td>
        <td>
          <span class="icon has-text-danger" onclick="removeLinha(this)">
            <i class="fa fa-times" aria-hidden="true"></i>
          </span>
        </td>
      </tr>
    </tbody>
  </table>

  <button class="button" onclick="abra()">Abra</button>

  <div class="modal" id="edita-vinculo">
    <div class="modal-background"></div>
    <div class="modal-card">
      <header class="modal-card-head">
        <p class="modal-card-title">Alterar vínculo</p>
        <button class="delete" aria-label="close" onclick="feche()"></button>
      </header>
      <section class="modal-card-body">
        <!-- Nome do vínculo (pessoa) -->
        <div class="field">
          <div class="control">
            <label for="" class="label is-normal" id="vinculo-nome-pessoa">não fornecido</label>
            <p class="help">Você não pode editar o vínculo (remova-o se for o caso).</p>
          </div>
        </div>
        <!-- Relacionamento -->
        <div class="field">
          <div class="control">
            <label class="label is-small">Relacionamento</label>
            <div class="select">
              <select>
                                <option value="7" selected>Avó materna</option>
                                <option value="8">Avô materno</option>
                                <option value="22">Cônjuge/companheiro(a)
                                </option>
                                <option value="23">Irmão</option>
                                <option value="24">Irmã</option>
                                <option value="25">Meio-irmão</option>
                                <option value="26">Meio-irmã</option>
                                <option value="27">Irmãos</option>
                                <option value="28">Criança</option>
                                <option value="29">Filha</option>
                                <option value="36">Avó paterna</option>
                                <option value="37">Avô paterno</option>
                                <option value="38">Tio materno</option>
                                <option value="40">Tio paterno</option>
                                <option value="41">Tia paterna</option>
                                <option value="189">Recém-nascido</option>
                                <option value="254">Pais</option>
                                <option value="262">Mãe adotiva</option>
                                <option value="263">Pai adotivo</option>
                                <option value="264">Responsável</option>
                                <option value="265">Coabitante</option>
                                <option value="939">Tia materna</option>
                            </select>
            </div>
          </div>
        </div>
        
        <div class="columns">
          <div class="column">
        <!-- data inicial -->
        <div class="field">
          <div class="control">
            <!-- data de início -->
            <label for="vinculo-di-atualiza" class="label is-small">Data de início</label>
            <input type="date" class="input" id="vinculo-di-atualiza">
          </div>
        </div>            
          </div>
          <div class="column">
        <!-- data final -->
        <div class="field">
          <div class="control">
            <label for="vinculo-df-atualiza" class="label is-small">Data final</label>
            <input type="date" class="input" id="vinculo-df-atualiza">
          </div>
        </div>            
          </div>
        </div>
      </section>
      <footer class="modal-card-foot">
        <button class="button is-success" onclick="atualize()">Atualize</button>
        <button class="button" onclick="feche()">Cancela</button>
      </footer>
    </div>
  </div>

</body>

</html>
